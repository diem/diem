<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `jellyfish_merkle` crate."><meta name="keywords" content="rust, rustlang, rust-lang, jellyfish_merkle"><title>jellyfish_merkle - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../dark.css"><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="../favicon.ico"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../jellyfish_merkle/index.html'><div class='logo-container'><img src='../rust-logo.png' alt='logo'></div></a><p class='location'>Crate jellyfish_merkle</p><div class="sidebar-elems"><a id='all-types' href='all.html'><p>See all jellyfish_merkle's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#constants">Constants</a></li><li><a href="#traits">Traits</a></li><li><a href="#types">Type Definitions</a></li></ul></div><p class='location'></p><script>window.sidebarCurrent = {name: 'jellyfish_merkle', ty: 'mod', relpath: '../'};</script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../src/jellyfish_merkle/lib.rs.html#4-610' title='goto source code'>[src]</a></span><span class='in-band'>Crate <a class="mod" href=''>jellyfish_merkle</a></span></h1><div class='docblock'><p>This module implements <a href="struct.JellyfishMerkleTree.html"><code>JellyfishMerkleTree</code></a> backed by storage module. The tree itself doesn't
persist anything, but realizes the logic of R/W only. The write path will produce all the
intermediate results in a batch for storage layer to commit and the read path will return
results directly. The public APIs are only <a href="struct.JellyfishMerkleTree.html#method.new"><code>new</code></a>, <a href="struct.JellyfishMerkleTree.html#method.put_blob_sets"><code>put_blob_sets</code></a>, <a href="struct.JellyfishMerkleTree.html#method.put_blob_set"><code>put_blob_set</code></a> and
<a href="struct.JellyfishMerkleTree.html#method.get_with_proof"><code>get_with_proof</code></a>. After each put with a <code>blob_set</code> based on a known version, the tree will
return a new root hash with a <a href="struct.TreeUpdateBatch.html"><code>TreeUpdateBatch</code></a> containing all the new nodes and indices of
stale nodes.</p>
<p>A Jellyfish Merkle Tree itself logically is a 256-bit sparse Merkle tree with an optimization
that any subtree containing 0 or 1 leaf node will be replaced by that leaf node or a placeholder
node with default hash value. With this optimization we can save CPU by avoiding hashing on
many sparse levels in the tree. Physically, the tree is structurally similar to the modified
Patricia Merkle tree of Ethereum but with some modifications. A standard Jellyfish Merkle tree
will look like the following figure:</p>
<pre><code class="language-text">                                   .──────────────────────.
                           _.─────'                        `──────.
                      _.──'                                        `───.
                  _.─'                                                  `──.
              _.─'                                                          `──.
            ,'                                                                  `.
         ,─'                                                                      '─.
       ,'                                                                            `.
     ,'                                                                                `.
    ╱                                                                                    ╲
   ╱                                                                                      ╲
  ╱                                                                                        ╲
 ╱                                                                                          ╲
;                                                                                            :
;                                                                                            :
;                                                                                              :
│                                                                                              │
+──────────────────────────────────────────────────────────────────────────────────────────────+
.''.  .''.  .''.  .''.  .''.  .''.  .''.  .''.  .''.  .''.  .''.  .''.  .''.  .''.  .''.  .''.
/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \
+----++----++----++----++----++----++----++----++----++----++----++----++----++----++----++----+
(  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
 )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )
(  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
 )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )
(  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
 )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )
(  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
 )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )
(  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■
■: account_state_blob
</code></pre>
<p>A Jellyfish Merkle Tree consists of <a href="node_type/struct.InternalNode.html"><code>InternalNode</code></a> and <a href="node_type/struct.LeafNode.html"><code>LeafNode</code></a>. <a href="node_type/struct.InternalNode.html"><code>InternalNode</code></a> is like
branch node in ethereum patricia merkle with 16 children to represent a 4-level binary tree and
<a href="node_type/struct.LeafNode.html"><code>LeafNode</code></a> is similar to that in patricia merkle too. In the above figure, each <code>bell</code> in the
jellyfish is an <a href="node_type/struct.InternalNode.html"><code>InternalNode</code></a> while each tentacle is a <a href="node_type/struct.LeafNode.html"><code>LeafNode</code></a>. It is noted that
Jellyfish merkle doesn't have a counterpart for <code>extension</code> node of ethereum patricia merkle.</p>
</div><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table><tr class='module-item'><td><a class="mod" href="iterator/index.html" title='jellyfish_merkle::iterator mod'>iterator</a></td><td class='docblock-short'><p>This module implements <code>JellyfishMerkleIterator</code>. Initialized with a version and a key, the
iterator generates all the key-value pairs in this version of the tree, starting from the
smallest key that is greater or equal to the given key, by performing a depth first traversal
on the tree.</p>
</td></tr><tr class='module-item'><td><a class="mod" href="node_type/index.html" title='jellyfish_merkle::node_type mod'>node_type</a></td><td class='docblock-short'><p>Node types of <a href="../jellyfish_merkle/struct.JellyfishMerkleTree.html"><code>JellyfishMerkleTree</code></a></p>
</td></tr><tr class='module-item'><td><a class="mod" href="restore/index.html" title='jellyfish_merkle::restore mod'>restore</a></td><td class='docblock-short'><p>This module implements the functionality to restore a <code>JellyfishMerkleTree</code> from small chunks
of accounts.</p>
</td></tr></table><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table><tr class='module-item'><td><a class="struct" href="struct.JellyfishMerkleTree.html" title='jellyfish_merkle::JellyfishMerkleTree struct'>JellyfishMerkleTree</a></td><td class='docblock-short'><p>The Jellyfish Merkle tree data structure. See <a href="../jellyfish_merkle/index.html" title="`crate`"><code>crate</code></a> for description.</p>
</td></tr><tr class='module-item'><td><a class="struct" href="struct.StaleNodeIndex.html" title='jellyfish_merkle::StaleNodeIndex struct'>StaleNodeIndex</a></td><td class='docblock-short'><p>Indicates a node becomes stale since <code>stale_since_version</code>.</p>
</td></tr><tr class='module-item'><td><a class="struct" href="struct.TreeUpdateBatch.html" title='jellyfish_merkle::TreeUpdateBatch struct'>TreeUpdateBatch</a></td><td class='docblock-short'><p>This is a wrapper of <a href="type.NodeBatch.html"><code>NodeBatch</code></a>,
<a href="type.StaleNodeIndexBatch.html"><code>StaleNodeIndexBatch</code></a> and some stats of nodes that represents
the incremental updates of a tree and pruning indices after applying a write set,
which is a vector of <code>hashed_account_address</code> and <code>new_account_state_blob</code> pairs.</p>
</td></tr></table><h2 id='constants' class='section-header'><a href="#constants">Constants</a></h2>
<table><tr class='module-item'><td><a class="constant" href="constant.ROOT_NIBBLE_HEIGHT.html" title='jellyfish_merkle::ROOT_NIBBLE_HEIGHT constant'>ROOT_NIBBLE_HEIGHT</a></td><td class='docblock-short'><p>The hardcoded maximum height of a <a href="../jellyfish_merkle/struct.JellyfishMerkleTree.html" title="`JellyfishMerkleTree`"><code>JellyfishMerkleTree</code></a> in nibbles.</p>
</td></tr></table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table><tr class='module-item'><td><a class="trait" href="trait.TreeReader.html" title='jellyfish_merkle::TreeReader trait'>TreeReader</a></td><td class='docblock-short'><p><code>TreeReader</code> defines the interface between
<a href="struct.JellyfishMerkleTree.html"><code>JellyfishMerkleTree</code></a>
and underlying storage holding nodes.</p>
</td></tr><tr class='module-item'><td><a class="trait" href="trait.TreeWriter.html" title='jellyfish_merkle::TreeWriter trait'>TreeWriter</a></td><td class='docblock-short'></td></tr></table><h2 id='types' class='section-header'><a href="#types">Type Definitions</a></h2>
<table><tr class='module-item'><td><a class="type" href="type.NodeBatch.html" title='jellyfish_merkle::NodeBatch type'>NodeBatch</a></td><td class='docblock-short'><p>Node batch that will be written into db atomically with other batches.</p>
</td></tr><tr class='module-item'><td><a class="type" href="type.StaleNodeIndexBatch.html" title='jellyfish_merkle::StaleNodeIndexBatch type'>StaleNodeIndexBatch</a></td><td class='docblock-short'><p><a href="struct.StaleNodeIndex.html"><code>StaleNodeIndex</code></a> batch that will be written into db atomically
with other batches.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../";window.currentCrate = "jellyfish_merkle";</script><script src="../aliases.js"></script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>